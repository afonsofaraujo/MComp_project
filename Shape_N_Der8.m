function [B, psi, Detj] = Shape_N_Der8(XN, csi, eta)
    psi = zeros(8, 1);
    psi(1) = (1 - csi) * (1 - eta) * (1 - csi - eta) / 4;
    psi(2) = (1 + csi) * (1 - eta) * (1 + csi - eta) / 4;
    psi(3) = (1 + csi) * (1 + eta) * (1 + csi + eta) / 4;
    psi(4) = (1 - csi) * (1 + eta) * (1 - csi + eta) / 4;
    psi(5) = (1 - csi^2) * (1 - eta) / 2;
    psi(6) = (1 + csi) * (1 - eta^2) / 2;
    psi(7) = (1 - csi^2) * (1 + eta) / 2;
    psi(8) = (1 - csi) * (1 - eta^2) / 2;
    Dpsi = zeros(8, 2);
    Dpsi(1, 1) = -(1 - eta) * (2 * csi + eta) / 4;
    Dpsi(2, 1) = (1 - eta) * (2 * csi - eta) / 4;
    Dpsi(3, 1) = (1 + eta) * (2 * csi + eta) / 4;
    Dpsi(4, 1) = -(1 + eta) * (2 * csi - eta) / 4;
    Dpsi(5, 1) = -csi * (1 - eta);
    Dpsi(6, 1) = (1 - eta^2) / 2;
    Dpsi(7, 1) = csi * (1 + eta);
    Dpsi(8, 1) = -(1 - eta^2) / 2;
    Dpsi(1, 2) = -(1 - csi) * (csi + 2 * eta) / 4;
    Dpsi(2, 2) = -(1 + csi) * (csi - 2 * eta) / 4;
    Dpsi(3, 2) = (1 + csi) * (csi + 2 * eta) / 4;
    Dpsi(4, 2) = (1 - csi) * (csi - 2 * eta) / 4;
    Dpsi(5, 2) = -(1 - csi^2) / 2;
    Dpsi(6, 2) = -eta * (1 + csi);
    Dpsi(7, 2) = (1 - csi^2) / 2;
    Dpsi(8, 2) = eta * (1 - csi);
    jaco = XN' * Dpsi;
    Detj = det(jaco);
    Invj = inv(jaco);
    B = Dpsi * Invj;
end